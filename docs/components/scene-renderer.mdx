---
title: "SceneRenderer (Internal)"
description: "Automatic body rendering — handled internally by MujocoSimProvider"
icon: "cube"
---

`SceneRenderer` is rendered automatically inside `MujocoSimProvider`. You do not need to import or add it to your scene tree — body rendering happens as soon as a model is loaded.

<Note>
  Prior to v1.1, `SceneRenderer` was a user-facing component that had to be added as a child of `MujocoCanvas`. It is now internal. Remove any `<SceneRenderer />` from your JSX and any `SceneRenderer` imports.
</Note>

## How It Works

1. **On load**: Creates a Three.js group hierarchy mirroring MuJoCo's body tree. Each body gets child meshes for its geoms, built from MuJoCo's geom type, size, and RGBA.

2. **Every frame** (priority 0): Updates each body group's `position` and `quaternion` from `data.xpos` and `data.xquat`.

3. **Selection**: Double-clicking a body fires the `onSelection` callback on `MujocoCanvas`.

## Geom Types

The renderer handles all standard MuJoCo geom types:

| Type | Three.js Geometry |
|------|-------------------|
| `box` | BoxGeometry |
| `sphere` | SphereGeometry |
| `cylinder` | CylinderGeometry |
| `capsule` | Custom CapsuleGeometry |
| `plane` | PlaneGeometry |
| `mesh` | Loaded from STL/OBJ assets |
| `ellipsoid` | Scaled SphereGeometry |

## Quaternion Convention

MuJoCo stores quaternions as `[w, x, y, z]`. Three.js expects `(x, y, z, w)`. The renderer handles this conversion automatically.

## Body IDs for Raycasting

The renderer sets `userData.bodyID` on every mesh it creates. When raycasting, walk up the object tree with `obj.parent` until you find a node with `userData.bodyID` -- child meshes (e.g. geom sub-meshes) don't have it directly, but their parent body group does.

```tsx
// Walk up the scene graph to find the body ID
let obj = hit.object;
while (obj) {
  if (obj.userData?.bodyID != null) {
    console.log('Hit body:', obj.userData.bodyID);
    break;
  }
  obj = obj.parent!;
}
```

## Notes

- Body 0 (the world body) is skipped -- it doesn't move
- Geom colors come from `model.geom_rgba`
- Mesh geoms require the asset files to be accessible at the model's `baseUrl`
